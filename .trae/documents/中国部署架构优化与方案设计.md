# Zeabur 中国部署架构优化方案

针对您希望在 **Zeabur** 部署且面向中国用户的需求，我重新评估了架构并制定了以下方案。

## 1. 架构问题诊断与优化

### 📂 数据持久化问题 (核心问题)
*   **诊断**: 当前网站使用 `src/data/siteData.json` 存储内容。Zeabur 默认是容器化部署，每次重新部署都会重置文件系统，导致后台修改的数据丢失。
*   **优化**: 
    1.  **方案 A (保持 JSON)**: 在 Zeabur 中为项目挂载 **Volume (持久化卷)**。
    2.  **方案 B (推荐)**: 接入数据库（Zeabur 自带 MongoDB/PostgreSQL）。为了快速上线，我们先采用 **方案 A**，但需要调整代码以支持外部路径。

### 🚀 中国访问速度
*   **诊断**: 默认域名访问可能较慢。
*   **优化**: 在 Zeabur 中选择 **Asia (香港/新加坡)** 节点。香港节点对中国大陆访问友好，无需备案即可快速打开。

### 📧 邮件通知
*   **诊断**: Node.js 直接发送邮件在云端易被拦截。
*   **优化**: 确保配置环境变量，并使用 SSL 465 端口连接 SMTP。

---

## 2. 技术调整计划

### 第一阶段：代码健壮性改造
1.  **环境变量支持**: 将数据存储路径改为可配置，优先读取 `DATA_PATH` 环境变量。
2.  **文件读写加固**: 增加并发读写锁，防止高频修改时损坏 JSON 文件。
3.  **静态资源优化**: 检查图片组件，确保支持从 CDN 或本地存储加载。

### 第二阶段：Zeabur 适配
1.  **配置文件**: 优化 `package.json` 的 build 脚本，确保在 Zeabur 环境下正确编译。
2.  **备份机制**: 在后台增加“导出 JSON”功能，方便随时下载备份数据。

---

## 3. Zeabur 部署方案步骤

### 步骤 1：准备仓库
*   我已经帮您同步了代码到 GitHub。

### 步骤 2：在 Zeabur 创建项目
1.  登录 [Zeabur 控制台](https://zeabur.com/)。
2.  点击 **"Create Project"**，选择离中国大陆近的区域（推荐 **Asia-East**）。
3.  点击 **"Deploy Service"** -> **"GitHub"**，选择您的仓库 `-1115`。

### 步骤 3：配置持久化卷 (非常重要)
1.  在服务详情页点击 **"Storage"**。
2.  创建一个新的 **Volume**。
3.  **挂载路径 (Mount Path)** 设置为 `/app/src/data`。这样您的 JSON 数据就会永远保存在服务器上。

### 步骤 4：绑定域名
1.  在 **"Networking"** 页面绑定您的域名或使用 Zeabur 提供的免费二级域名。

---

## 4. 下一步操作
如果您确认此方案，我将立即为您进行 **代码健壮性调整**（主要是文件路径兼容性和环境变量支持），完成后您只需在 Zeabur 点击部署即可。

**是否开始执行代码调整？**
